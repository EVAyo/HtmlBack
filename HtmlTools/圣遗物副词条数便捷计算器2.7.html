<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> <html xmlns=http://www.w3.org/1999/xhtml class=single-file-cut-mode><!--
 Page saved with SingleFile 
 url: http://spongem.com/ajglz/ys/ys.html# 
 saved date: Wed Jun 08 2022 03:01:48 GMT+0800 (中国标准时间)
--><meta charset=utf-8><meta name=viewport content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>圣遗物副词条数便捷计算器</title><meta name=script content=run><link type=image/x-icon rel="shortcut icon" href=data:image/vnd.microsoft.icon;base64,><link rel=canonical href=http://spongem.com/ajglz/ys/ys.html#><style>img[src="data:,"],source[src="data:,"]{display:none!important}</style><body class><remove-web-limits-iqxin id=rwl-iqxin class=rwl-exempt style=position:fixed;top:95px;left:0px><qxinbutton type=qxinbutton id=rwl-setbtn> set </qxinbutton> <lalala style=cursor:move;font-size:12px>限制解除</lalala> <input type=checkbox name id=black_node><style type=text/css>#rwl-iqxin{position:fixed;transform:translate(-95px,0);width:85px;height:25px;font-size:12px;font-weight:500;font-family:Verdana,Arial,"宋体";color:#fff;background:#333;z-index:2147483647;margin:0;opacity:0.05;transition:0.3s;overflow:hidden;user-select:none;text-align:center;white-space:nowrap;line-height:25px;padding:0 16px;border:1px solid #ccc;border-width:1px 1px 1px 0;border-bottom-right-radius:5px;box-sizing:content-box}#rwl-iqxin input{margin:0;padding:0;vertical-align:middle;-webkit-appearance:checkbox;-moz-appearance:checkbox;position:static;clip:auto;opacity:1;cursor:pointer}#rwl-iqxin.rwl-active-iqxin{left:0px;transform:translate(0,0);opacity:0.9;height:32px;line-height:32px}#rwl-iqxin label{margin:0;padding:0;font-weight:500}#rwl-iqxin #rwl-setbtn{margin:0 4px 0 0;padding:0 0 0 4px;border:none;border-radius:2px;cursor:pointer;background:#fff;color:#000}</style><style type=text/css>#rwl-iqxin{position:fixed;transform:translate(-95px,0);width:85px;height:25px;font-size:12px;font-weight: 500;font-family:Verdana, Arial, '宋体';color:#fff;background:#333;z-index:2147483647;margin: 0;opacity:0.05;transition:0.3s;overflow:hidden;user-select:none;text-align:center;white-space:nowrap;line-height:25px;padding:0 16px;border:1px solid #ccc;border-width:1px 1px 1px 0;border-bottom-right-radius:5px;box-sizing: content-box;}#rwl-iqxin input{margin: 0;padding: 0;vertical-align:middle;-webkit-appearance:checkbox;-moz-appearance:checkbox;position: static;clip: auto;opacity: 1;cursor: pointer;}#rwl-iqxin.rwl-active-iqxin{left: 0px;transform:translate(0,0);opacity: 0.9;height: 32px;line-height: 32px}#rwl-iqxin label{margin:0;padding:0;font-weight:500;}#rwl-iqxin #rwl-setbtn{margin: 0 4px 0 0;padding: 0 0 0 4px;border: none;border-radius: 2px;cursor: pointer;background: #fff;color: #000;} </style></remove-web-limits-iqxin>
    
    
    
    <style type=text/css>.link{color:#03F;text-decoration:none}body{margin:0px;padding:0px;overflow-x:hidden;background:#FFF}hr.fgx{border:1px dashed #2E9FCC}.wb{font-size:80%}p.t{font-size:140%;font-weight:800;color:#1F4499;text-align:center;font-family:"Microsoft YaHei"}p.lt{color:#1F4499;font-weight:800}table.gridtable{font-family:verdana,arial,sans-serif;font-size:11px;color:#333333;border-width:1px;border-color:#666666;border-collapse:collapse}table.gridtable th{border-width:1px;padding:8px;border-style:solid;border-color:#666666;background-color:#dedede}table.gridtable td{border-width:1px;padding:8px;border-style:solid;border-color:#666666;background-color:#ffffff}.td-3{width:250px}.tip{margin-left:60px;margin-right:60px}input[type="text"]{border-radius:4px;border:solid 1px #AAAAAA;font-family:"黑体";padding:5px}button{color:#444444;background:#F3F3F3;border:1px #DADADA solid;padding:5px 10px;border-radius:2px;font-size:10pt;outline:none}button:hover{border:1px #C6C6C6 solid;box-shadow:1px 1px 1px #EAEAEA;color:#333333;background:#F7F7F7}button:active{box-shadow:inset 1px 1px 1px #DFDFDF}button.blue{color:white;background:#4C8FFB;border:1px #3079ED solid;box-shadow:inset 0 1px 0#80B0FB}button.blue:hover{border:1px #2F5BB7 solid;box-shadow:0 1px 1px #EAEAEA,inset 0 1px 0#5A94F1;background:#3F83F1}button.blue:active{box-shadow:inset 0 2px 5px #2370FE}button.orange{color:white;border:1px solid #FB8F3D;background:-webkit-linear-gradient(top,#FDA251,#FB8F3D);background:-moz-linear-gradient(top,#FDA251,#FB8F3D);background:-ms-linear-gradient(top,#FDA251,#FB8F3D)}button.orange:hover{border:1px solid #EB5200;background:-webkit-linear-gradient(top,#FD924C,#F9760B);background:-moz-linear-gradient(top,#FD924C,#F9760B);background:-ms-linear-gradient(top,#FD924C,#F9760B);box-shadow:0 1px #EFEFEF}button.orange:active{box-shadow:inset 0 1px 1px rgba(0,0,0,0.3)}button.red{background:-webkit-linear-gradient(top,#DD4B39,#D14836);background:-moz-linear-gradient(top,#DD4B39,#D14836);background:-ms-linear-gradient(top,#DD4B39,#D14836);border:1px solid #DD4B39;color:white;text-shadow:0 1px 0#C04131}button.red:hover{background:-webkit-linear-gradient(top,#DD4B39,#C53727);background:-moz-linear-gradient(top,#DD4B39,#C53727);background:-ms-linear-gradient(top,#DD4B39,#C53727);border:1px solid #AF301F}button.red:active{box-shadow:inset 0 1px 1px rgba(0,0,0,0.2);background:-webkit-linear-gradient(top,#D74736,#AD2719);background:-moz-linear-gradient(top,#D74736,#AD2719);background:-ms-linear-gradient(top,#D74736,#AD2719)}</style>
<input type=hidden id=_o_dbjbempljhcmhlfpfacalomonjpalpko data-inspect-config=3 value hidden><script type=text/javascript src=moz-extension://07216c7c-0897-416c-8ae1-0e46f9e20b14/scripts/inspector.js></script>


<p class=t>圣遗物副词条数便捷计算器</p>


<hr class=fgx>
<div id=page1 class>
<!--角色列表point-->
<p class align=center>角色：
<select id=Char onchange=SetCharL()>
<optgroup label=风-Anemo>
<option selected>温迪</option>
<option>琴</option>
<option>魈</option>
<option>风旅行者</option>
<option>砂糖</option>
<option>枫原万叶</option>
<option>早柚</option>
</optgroup>
<optgroup label=水-Hydro>
<option>达达利亚</option>
<option>莫娜</option>
<option>行秋</option>
<option>芭芭拉</option>
<option>珊瑚宫心海</option>
<option>神里绫人</option>
<option>夜兰</option>
</optgroup>
<optgroup label=火-Pyro>
<option>迪卢克</option>
<option>可莉</option>
<option>胡桃</option>
<option>班尼特</option>
<option>香菱</option>
<option>安柏</option>
<option>辛焱</option>
<option>烟绯</option>
<option>宵宫</option>
<option>托马</option>
</optgroup>
<optgroup label=冰-Cyro>
<option>七七</option>
<option>甘雨</option>
<option>优菈</option>
<option>重云</option>
<option>迪奥娜</option>
<option>凯亚</option>
<option>罗莎莉亚</option>
<option>神里绫华</option>
<option>埃洛伊</option>
<option>申鹤</option>
</optgroup>
<optgroup label=雷-Electro>
<option>刻晴</option>
<option>菲谢尔</option>
<option>雷旅行者</option>
<option>北斗</option>
<option>雷泽</option>
<option>丽莎</option>
<option>雷电将军</option>
<option>九条裟罗</option>
<option>八重神子</option>
<option>久岐忍</option>
</optgroup>
<optgroup label=岩-Geo>
<option>钟离</option>
<option>阿贝多</option>
<option>岩旅行者</option>
<option>凝光</option>
<option>诺艾尔</option>
<option>荒泷一斗</option>
<option>五郎</option>
<option>云堇</option>
</optgroup>
</select>
</p>

<p class align=center>等级：
<select id=Level onchange=SetChar(0)>
<option value=2 selected>90级</option>
 <option value=1>80级已突破</option>
</select>
</p>

<p class=lt align=center>——圣遗物主属性——</p>
<p align=center>沙：
<select id=A1 onchange=SetChar(0)>
<option value=1>生命值%</option>
<option value=2 selected>攻击力%</option>
<option value=3>防御力%</option>
<option value=4>元素精通</option>
<option value=5>充能效率</option>
</select>

杯：
<select id=A2 onchange=SetChar(0) class>
<option value=1>生命值%</option>
<option value=2>攻击力%</option>
<option value=3>防御力%</option>
<option value=4>元素精通</option>
<option value=8 selected>属性伤害</option>
</select>

头：
<select id=A3 onchange=SetChar(0)>
<option value=1>生命值%</option>
<option value=2>攻击力%</option>
<option value=3>防御力%</option>
<option value=4>元素精通</option>
<option value=6>暴击率</option>
<option value=7 selected>暴击伤害</option>
<option value=9>治疗加成</option>
</select>

</p>
<p class=lt align=center>——武器攻击力白值——</p>
<p class align=center><input type=text id=QQ value=0 onchange="SetCharS('QQ')" class></p>
<p id=WeaponList class align=center><select id=Weapon onchange=SetWeapon() class><option value=0>选择武器<option value=674>天空之翼<option value=608>阿莫斯/冬极/飞雷/终末<option value=542>若水<option value=565>祭礼弓/暗巷猎手/落霞<option value=510>弓藏/绿弓/风花/绝弦/试作<option value=454>西风猎弓/钢轮弓/破魔之弓</select></p>

<p class=lt align=center>——在圣遗物详情界面里——</p>
<p class align=center>+生命值：<input type=text id=T1 value=0 onchange="SetCharS('T1')"></p>
<p class align=center>+攻击力：<input type=text id=T2 value=0 onchange="SetCharS('T2')" class></p>
<p class align=center>+防御力：<input type=text id=T3 value=0 onchange="SetCharS('T3')"></p>
<p class align=center>+元素精通：<input type=text id=T4 value=0 onchange="SetCharS('T4')" class>	</p>
<p class align=center>+暴击率%：<input type=text id=T5 value=0 onchange="SetCharS('T5')" class>	</p>
<p class align=center>+暴击伤害%：<input type=text id=T6 value=0 onchange="SetCharS('T6')" class>	</p>
<p class align=center>+充能效率%：<input type=text id=T7 value=0 onchange="SetCharS('T7')" class>	</p>

<p class=lt id=anchor align=center>——总结——</p>
<p id=result2 align=center></p>
<p id=result class align=center>暂无结果</p>
<p class>&nbsp;</p>

<p id=setlabel class align=center>方案：<select id=Sets onchange=SetChar(2) class><option>1</select> <button type=button onclick=addset() class> 新增方案</button> <button type=button onclick=SetChar(1)>复制此结果</button></p>
</div>
<div id=buttonlabel class align=center><button class=blue type=button onclick="ShowPage2(1);window.location.href='#page1'"> 查看本地记录</button> <button type=button onclick=remove() class=red> 清除该数据</button></div>
<p class>&nbsp;</p>
<p class>&nbsp;</p>
<p class>&nbsp;</p>
<p class>&nbsp;</p>
<p class>&nbsp;</p>
<p class>&nbsp;</p>
<p class>&nbsp;</p>
<p class>&nbsp;</p>
<p class>&nbsp;</p>

<script>
var r=[0,0,0,0,0,0,0];
var cc=[0,0,0,0,0,0,0];
var ShowLoad=""
var setsum=1
var onloading=true
var charcache
var lastcheck=-1;
var lastcheckstr="";

//角色数据point
function userobject(name){ 
switch(name){
case "温迪":
this.lv80a={baseHP:9791.154310719692,baseDEF:621.6392653943294,baseATK:244.60097321190642,energyRecharge:31.999999284744263},this.lv90={baseHP:10531.48386939941,baseDEF:668.6423311858234,baseATK:263.09622679515087,energyRecharge:31.999999284744263}
this.mode=11
this.Etype=1
break;
case "琴":
this.lv80a={baseHP:13662.07554812677,baseDEF:714.5278892422866,baseATK:222.3645244843292,healing:22.14999943971634},this.lv90={baseHP:14695.093513910891,baseDEF:768.55440212143,baseATK:239.17839184791592,healing:22.14999943971634}
this.mode=3
this.Etype=1
break;
case "魈":
this.lv80a={baseHP:11840.465424213122,baseDEF:743.1090066680572,baseATK:324.65219912465363,critRate:24.200000166893005},this.lv90={baseHP:12735.747672248981,baseDEF:799.2965799245794,baseATK:349.2004441320678,critRate:24.200000166893005}
this.mode=0
this.Etype=1
break;
case "风旅行者":
this.lv80a={baseHP:10121.775421069935,baseDEF:635.2536499864582,baseATK:197.68778471910082,percentATK:23.999999463558197},this.lv90={baseHP:10874.91499475576,baseDEF:682.5215109506607,baseATK:212.39719698963927,percentATK:23.999999463558197}
this.mode=11
this.Etype=1
break;
case "砂糖":
this.lv80a={baseHP:8603.508985277615,baseDEF:654.3112699264966,baseATK:158.1502227076462,anemoDamage:23.999999463558197},this.lv90={baseHP:9243.677602744545,baseDEF:702.9971676649075,baseATK:169.91775205143585,anemoDamage:23.999999463558197}
this.mode=9
this.Etype=1
break;
case "达达利亚":
this.lv80a={baseHP:12182.017518934357,baseDEF:757.3995351761696,baseATK:280.1793016694992,hydroDamage:28.79999876022339},this.lv90={baseHP:13103.125224382035,baseDEF:814.6676368990447,baseATK:301.3647742375979,hydroDamage:28.79999876022339}
this.mode=1
this.Etype=2
break;
case "莫娜":
this.lv80a={baseHP:9677.303449718864,baseDEF:607.3486917354603,baseATK:266.83742193948365,energyRecharge:31.999999284744263},this.lv90={baseHP:10409.024522594642,baseDEF:653.2712256159284,baseATK:287.0140617423858,energyRecharge:31.999999284744263}
this.mode=2
this.Etype=2
break;
case "行秋":
this.lv80a={baseHP:9514.46903624275,baseDEF:705.1315610686324,baseATK:187.8033969635344,percentATK:23.999999463558197},this.lv90={baseHP:10222.420237524027,baseDEF:757.5988870539913,baseATK:201.77733869931944,percentATK:23.999999463558197}
this.mode=2
this.Etype=2
break;
case "芭芭拉":
this.lv80a={baseHP:9109.597725532774,baseDEF:622.5485987243992,baseATK:148.26583495207979,percentHP:23.999999463558197},this.lv90={baseHP:9787.423311600985,baseDEF:668.8711049900703,baseATK:159.29789376111603,percentHP:23.999999463558197}
this.mode=8
this.Etype=2
break;
case "迪卢克":
this.lv80a={baseHP:12068.166902074154,baseDEF:728.8184330091881,baseATK:311.3103343406219,critRate:24.200000166893005},this.lv90={baseHP:12980.666121717892,baseDEF:783.9254743546844,baseATK:334.84974830517604,critRate:24.200000166893005}
this.mode=1
this.Etype=3
break;
case "可莉":
this.lv80a={baseHP:9563.45283285866,baseDEF:571.6222874802552,baseATK:289.0738706670609,pyroDamage:28.79999876022339},this.lv90={baseHP:10286.565419930499,baseDEF:614.8434950278315,baseATK:310.93189668962077,pyroDamage:28.79999876022339}
this.mode=1
this.Etype=3
break;
case "胡桃":
this.lv80a={baseHP:14459.029866148194,baseDEF:814.5617700277107,baseATK:98.95221210261116,critDamage:88.40000033378601},this.lv90={baseHP:15552.307232559891,baseDEF:876.1519925053435,baseATK:106.43438284689182,critDamage:88.40000033378601}
this.mode=6
this.Etype=3
break;
case "班尼特":
this.lv80a={baseHP:11538.82421229023,baseDEF:717.8366544678356,baseATK:177.9190053932707,energyRecharge:26.669999957084656},this.lv90={baseHP:12397.403338391683,baseDEF:771.2493414536075,baseATK:191.15747659430235,energyRecharge:26.669999957084656}
this.mode=2
this.Etype=3
break;
case "香菱":
this.lv80a={baseHP:10121.775421069935,baseDEF:622.5485987243992,baseATK:209.54904563010496,elementalMastery:96},this.lv90={baseHP:10874.91499475576,baseDEF:668.8711049900703,baseATK:225.14102222725342,elementalMastery:96}
this.mode=2
this.Etype=3
break;
case "安柏":
this.lv80a={baseHP:8805.94451856229,baseDEF:559.0232276222378,baseATK:207.5721762893645,percentATK:23.999999463558197},this.lv90={baseHP:9461.175943635753,baseDEF:600.6189477914886,baseATK:223.01705909465636,percentATK:23.999999463558197}
this.mode=1
this.Etype=3
break;
case "辛焱":
this.lv80a={baseHP:10425.428383899794,baseDEF:743.2467569919536,baseATK:231.29469811137278,percentATK:23.999999463558197},this.lv90={baseHP:11201.162118580367,baseDEF:798.5501533747884,baseATK:248.50470956988465,percentATK:23.999999463558197}
this.mode=23
this.Etype=3
break;
case "烟绯":
this.lv80a={baseHP:8704.726873990265,baseDEF:546.3181629210012,baseATK:223.38718351124407,pyroDamage:23.999999463558197},this.lv90={baseHP:9352.426895260462,baseDEF:586.9685252407799,baseATK:240.00881822685915,pyroDamage:23.999999463558197}
this.mode=1
this.Etype=3
break;
case "七七":
this.lv80a={baseHP:11498.913573632512,baseDEF:857.4334312203828,baseATK:266.83742193948365,healing:22.14999943971634},this.lv90={baseHP:12368.370364256552,baseDEF:922.2652425417473,baseATK:287.0140617423858,healing:22.14999943971634}
this.mode=0
this.Etype=4
break;
case "甘雨":
this.lv80a={baseHP:9108.050365417846,baseDEF:585.9128611391243,baseATK:311.3103343406219,critDamage:88.40000033378601},this.lv90={baseHP:9796.729009273928,baseDEF:630.2146005977265,baseATK:334.84974830517604,critDamage:88.40000033378601}
this.mode=1
this.Etype=4
break;
case "优菈":
this.lv80a={baseHP:12295.867657523078,baseDEF:698.0937476574509,baseATK:317.9812667326378,critDamage:88.40000033378601},this.lv90={baseHP:13225.583793659927,baseDEF:750.8776498723164,baseATK:342.0250962186219,critDamage:88.40000033378601}
this.mode=10
this.Etype=4
break;
case "重云":
this.lv80a={baseHP:10222.993309782585,baseDEF:603.4909787843608,baseATK:207.5721762893645,percentATK:23.999999463558197},this.lv90={baseHP:10983.664287271677,baseDEF:648.3954482758236,baseATK:223.01705909465636,percentATK:23.999999463558197}
this.mode=1
this.Etype=4
break;
case "迪奥娜":
this.lv80a={baseHP:8907.16240727494,baseDEF:559.0232276222378,baseATK:197.68778471910082,cryoDamage:23.999999463558197},this.lv90={baseHP:9569.92523615167,baseDEF:600.6189477914886,baseATK:212.39719698963927,cryoDamage:23.999999463558197}
this.mode=8
this.Etype=4
break;
case "凯亚":
this.lv80a={baseHP:10830.29969460977,baseDEF:736.8942170119408,baseATK:207.5721762893645,energyRecharge:26.669999957084656},this.lv90={baseHP:11636.159044503409,baseDEF:791.7249344700394,baseATK:223.01705909465636,energyRecharge:26.669999957084656}
this.mode=1
this.Etype=4
break;
case "罗莎莉亚":
this.lv80a={baseHP:11437.60632357758,baseDEF:660.6638099065094,baseATK:223.38718351124407,percentATK:23.999999463558197},this.lv90={baseHP:12288.654045875766,baseDEF:709.8223865696564,baseATK:240.00881822685915,percentATK:23.999999463558197}
this.mode=1
this.Etype=4
break;
case "刻晴":
this.lv80a={baseHP:12182.017518934357,baseDEF:743.1090066680572,baseATK:300.1920912161522,critDamage:88.40000033378601},this.lv90={baseHP:13103.125224382035,baseDEF:799.2965799245794,baseATK:322.890810348541,critDamage:88.40000033378601}
this.mode=0
this.Etype=5
break;
case "菲谢尔":
this.lv80a={baseHP:8552.899918850977,baseDEF:552.670702901014,baseATK:227.34095180049735,percentATK:23.999999463558197},this.lv90={baseHP:9189.302834416274,baseDEF:593.7937441455288,baseATK:244.256775675296,percentATK:23.999999463558197}
this.mode=3
this.Etype=5
break;
case "北斗":
this.lv80a={baseHP:12146.13013794995,baseDEF:603.4909787843608,baseATK:209.54904563010496,electroDamage:23.999999463558197},this.lv90={baseHP:13049.897586040897,baseDEF:648.3954482758236,baseATK:225.14102222725342,electroDamage:23.999999463558197}
this.mode=0
this.Etype=5
break;
case "雷泽":
this.lv80a={baseHP:11133.952901580255,baseDEF:698.7790210886196,baseATK:217.45656023023366,physicalDamage:30.000001192092896},this.lv90={baseHP:11962.406412468641,baseDEF:750.7736681492424,baseATK:233.63691357027892,physicalDamage:30.000001192092896}
this.mode=0
this.Etype=5
break;
case "丽莎":
this.lv80a={baseHP:8907.16240727494,baseDEF:533.6130829609756,baseATK:215.47968326009868,elementalMastery:96},this.lv90={baseHP:9569.92523615167,baseDEF:573.318087431282,baseATK:231.51294280828733,elementalMastery:96}
this.mode=0
this.Etype=5
break;
case "钟离":
this.lv80a={baseHP:13662.07554812677,baseDEF:685.9467419245484,baseATK:233.482737404026,geoDamage:28.79999876022339},this.lv90={baseHP:14695.093513910891,baseDEF:737.81219098164,baseATK:251.1372978774416,geoDamage:28.79999876022339}
this.mode=5
this.Etype=6
break;
case "阿贝多":
this.lv80a={baseHP:12295.867657523078,baseDEF:814.5617700277107,baseATK:233.48275266281507,geoDamage:28.79999876022339},this.lv90={baseHP:13225.583793659927,baseDEF:876.1519925053435,baseATK:251.13731313623066,geoDamage:28.79999876022339}
this.mode=4
this.Etype=6
break;
case "岩旅行者":
this.lv80a={baseHP:10121.775421069935,baseDEF:635.2536499864582,baseATK:197.68778471910082,percentATK:23.999999463558197},this.lv90={baseHP:10874.91499475576,baseDEF:682.5215109506607,baseATK:212.39719698963927,percentATK:23.999999463558197}
this.mode=3
this.Etype=6
break;
case "凝光":
this.lv80a={baseHP:9109.597725532774,baseDEF:533.6130829609756,baseATK:197.68778471910082,geoDamage:23.999999463558197},this.lv90={baseHP:9787.423311600985,baseDEF:573.318087431282,baseATK:212.39719698963927,geoDamage:23.999999463558197}
this.mode=0
this.Etype=6
break;
case "诺艾尔":
this.lv80a={baseHP:11235.17054615228,baseDEF:743.2467569919536,baseATK:177.9190053932707,percentDEF:30.000001192092896},this.lv90={baseHP:12071.155460843933,baseDEF:798.5501533747884,baseATK:191.15747659430235,percentDEF:30.000001192092896}
this.mode=7
this.Etype=6
break;
case "枫原万叶":
this.lv80a={baseHP:12410,baseDEF:750,baseATK:276,elementalMastery:115.2},this.lv90={baseHP:13348,baseDEF:807,baseATK:297,elementalMastery:115.2}
this.mode=12
this.Etype=1
break;
case "神里绫华":
this.lv80a={baseHP:11954,baseDEF:729,baseATK:318,critDamage:88.4},this.lv90={baseHP:12858,baseDEF:784,baseATK:342,critDamage:88.4}
this.mode=10
this.Etype=4
break;
case "早柚":
this.lv80a={baseHP:11033,baseDEF:693,baseATK:227,elementalMastery:96},this.lv90={baseHP:11854,baseDEF:745,baseATK:244,elementalMastery:96}
this.mode=3
this.Etype=1
break;
case "宵宫":
this.lv80a={baseHP:9450,baseDEF:572,baseATK:300,critRate:24.2},this.lv90={baseHP:10164,baseDEF:615,baseATK:323,critRate:24.2}
this.mode=1
this.Etype=3
break;
case "九条裟罗":
this.lv80a={baseHP:8907,baseDEF:584,baseATK:182},this.lv90={baseHP:9570,baseDEF:628,baseATK:195}
this.mode=3
this.Etype=5
break;
case "雷电将军":
this.lv80a={baseHP:12000,baseDEF:734,baseATK:314},this.lv90={baseHP:12907,baseDEF:789,baseATK:337}
this.mode=13
this.Etype=5
break;
case "珊瑚宫心海":
this.lv80a={baseHP:12524,baseDEF:611,baseATK:218},this.lv90={baseHP:13471,baseDEF:657,baseATK:234}
this.mode=14
this.Etype=2
break;
case "埃洛伊":
this.lv80a={baseHP:10133,baseDEF:629,baseATK:217},this.lv90={baseHP:10899,baseDEF:676,baseATK:234}
this.mode=1
this.Etype=4
break;
case "托马":
this.lv80a={baseHP:9616,baseDEF:699,baseATK:188},this.lv90={baseHP:10331,baseDEF:751,baseATK:202}
this.mode=15
this.Etype=3
break;
case "荒泷一斗":
this.lv80a={baseHP:11954,baseDEF:892,baseATK:211},this.lv90={baseHP:12858,baseDEF:959,baseATK:227}
this.mode=7
this.Etype=6
break;
case "五郎":
this.lv80a={baseHP:8907,baseDEF:603,baseATK:170},this.lv90={baseHP:9570,baseDEF:648,baseATK:183}
this.mode=16
this.Etype=6
break;
case "申鹤":
this.lv80a={baseHP:12080,baseDEF:772,baseATK:282},this.lv90={baseHP:12993,baseDEF:830,baseATK:304}
this.mode=17
this.Etype=4
break;
case "云堇":
this.lv80a={baseHP:9919,baseDEF:684,baseATK:178},this.lv90={baseHP:10657,baseDEF:734,baseATK:191}
this.mode=16
this.Etype=6
break;
case "八重神子":
this.lv80a={baseHP:9643,baseDEF:529,baseATK:316},this.lv90={baseHP:10372,baseDEF:569,baseATK:340}
this.mode=18
this.Etype=5
break;
case "神里绫人":
this.lv80a={baseHP:12751,baseDEF:715,baseATK:278},this.lv90={baseHP:13715,baseDEF:769,baseATK:299}
this.mode=20
this.Etype=2
break;
case "雷旅行者":
this.lv80a={baseHP:10121.775421069935,baseDEF:635.2536499864582,baseATK:197.68778471910082,percentATK:23.999999463558197},this.lv90={baseHP:10874.91499475576,baseDEF:682.5215109506607,baseATK:212.39719698963927,percentATK:23.999999463558197}
this.mode=19
this.Etype=5
break;
case "夜兰":
this.lv80a={baseHP:13434,baseDEF:509,baseATK:227,percentATK:23.999999463558197},this.lv90={baseHP:14450,baseDEF:548,baseATK:244,percentATK:23.999999463558197}
this.mode=21
this.Etype=2
break;
case "久岐忍":
this.lv80a={baseHP:11438,baseDEF:699,baseATK:198,percentATK:23.999999463558197},this.lv90={baseHP:12289,baseDEF:751,baseATK:212.39719698963927,percentATK:23.999999463558197}
this.mode=22
this.Etype=5
break;

	default:
break;
	}
}

function SetCharS(n){
	if (isNaN(GetE(n))){
		document.getElementById(n).value="0"
	}else{
		document.getElementById(n).value=GetE(n).toString()
	}
	SetChar(0)
}

function SetCharL(){
	var temp
	var temphtml='方案：<select id="Sets" onchange="SetChar(2)"><option>1<\/option>'
	var temphtml2='<\/select> <button type="button" onclick="addset()"> 新增方案<\/button>'
	var temphtml3=' <button type="button" onclick="SetChar(1)">复制此结果<\/button>'
	setsum=1
	for (var i =2;i<=10; i++) {
		temp=window.localStorage.getItem("ys"+document.getElementById('Char').value +i.toString())
		if (temp!=null && temp!=""){
			setsum+=1
			temphtml+='<option>'+i.toString()+'<\/option>'
		}
	}
	console.log(document.getElementById('Char').value)
	if(onloading!=true){window.localStorage.setItem("ysbjjsq",document.getElementById('Char').value)}
	document.getElementById('setlabel').innerHTML=temphtml+temphtml2+temphtml3
	SetChar(2)
}

function addset(){
	setsum+=1
	var temphtml='方案：<select id="Sets" onchange="SetChar(2)">'
	var temphtml2='<\/select> <button type="button" onclick="addset()"> 新增方案<\/button>'
	var temphtml3=' <button type="button" onclick="SetChar(1)">复制此结果<\/button>'
	for (var i =1;i<=setsum; i++) {
			temphtml+='<option>'+i.toString()+'<\/option>'
	}
	document.getElementById('setlabel').innerHTML=temphtml+temphtml2+temphtml3
	document.getElementById('Sets').options[setsum-1].selected=true
		document.getElementById('Level').options[0].selected=true;
		document.getElementById('A1').options[1].selected=true;
		document.getElementById('A2').options[4].selected=true;
		document.getElementById('A3').options[5].selected=true;
		document.getElementById('QQ').value="0"
		document.getElementById('T1').value="0"
		document.getElementById('T2').value="0"
		document.getElementById('T3').value="0"
		document.getElementById('T4').value="0"
		document.getElementById('T5').value="0"
		document.getElementById('T6').value="0"
		document.getElementById('T7').value="0"
		document.getElementById('result2').innerHTML=""
		document.getElementById('result').innerHTML="暂无结果"
		window.location.href='#page1'
}

function remove(){
	var temp=document.getElementById('Sets').value
	var temp2="-方案"+temp
	var temp3
	if(temp=='1'){
	temp=''
	temp2=""
	window.localStorage.removeItem('ys'+document.getElementById('Char').value);
	}else{
		for (var i =parseInt(temp);i<=setsum; i++) {
			temp3=window.localStorage.getItem("ys"+document.getElementById('Char').value +(i+1).toString())
			if (temp3!="" && temp3!=null){
				window.localStorage.setItem("ys"+document.getElementById('Char').value +i.toString(),temp3)
			}else{
				window.localStorage.removeItem('ys'+document.getElementById('Char').value + i.toString());
			}
		}
	}
	alert("已清除本地储存里"+document.getElementById('Char').value+temp2+"的数据！")
	SetCharL()
}

function Save(name){
	var temp=document.getElementById('Sets').value
	if(temp=='1'){temp=''}
	n=document.getElementById('Level').value+"/"+document.getElementById('QQ').value+"/"+document.getElementById('T1').value+"/"+document.getElementById('T2').value+"/"+document.getElementById('T3').value+"/"+document.getElementById('T4').value+"/"+document.getElementById('T5').value+"/"+document.getElementById('T6').value+"/"+document.getElementById('T7').value+"/"
	n=n+document.getElementById('A1').value+"/"+document.getElementById('A2').value+"/"+document.getElementById('A3').value+"/"
	n=n+r[0].toFixed(1).toString()+"/"+r[1].toFixed(1).toString()+"/"+r[2].toFixed(1).toString()+"/"+r[3].toFixed(1).toString()+"/"+r[5].toFixed(1).toString()+"/"+r[6].toFixed(1).toString()+"/"+r[4].toFixed(1).toString()
		if (ShowLoad==""){
			n=n+"/0100110"
		}else{
			n=n+"/"+ShowLoad
		}
	window.localStorage.setItem("ys"+name+temp,n)
}

function Load(){
	var temp=document.getElementById('Sets').value
	if(temp=='1'){temp=''}
	n=window.localStorage.getItem("ys"+document.getElementById('Char').value+temp)
	if(n!=null){
		temp=n.split("/");
		document.getElementById('Level').options[2-parseInt(temp[0])].selected=true;
		document.getElementById('QQ').value=temp[1]
		document.getElementById('T1').value=temp[2]
		document.getElementById('T2').value=temp[3]
		document.getElementById('T3').value=temp[4]
		document.getElementById('T4').value=temp[5]
		document.getElementById('T5').value=temp[6]
		document.getElementById('T6').value=temp[7]
		document.getElementById('T7').value=temp[8]
		for (var i =0;i<=6; i++) {
			if(i<=4){if(document.getElementById('A1').options[i].value==parseInt(temp[9])){document.getElementById('A1').options[i].selected=true}}
			if(i<=4){if(document.getElementById('A2').options[i].value==parseInt(temp[10])){document.getElementById('A2').options[i].selected=true}}
			if(document.getElementById('A3').options[i].value==parseInt(temp[11])){document.getElementById('A3').options[i].selected=true}
		}
		ShowLoad=temp[19]
		if (ShowLoad=="" || ShowLoad==undefined){
			ShowLoad="0100110"
		}
		return true
	}else{
		document.getElementById('Level').options[0].selected=true;
		document.getElementById('A1').options[1].selected=true;
		document.getElementById('A2').options[4].selected=true;
		document.getElementById('A3').options[5].selected=true;
		document.getElementById('QQ').value="0"
		document.getElementById('T1').value="0"
		document.getElementById('T2').value="0"
		document.getElementById('T3').value="0"
		document.getElementById('T4').value="0"
		document.getElementById('T5').value="0"
		document.getElementById('T6').value="0"
		document.getElementById('T7').value="0"
		ShowLoad=""
		return false
	}
}

function SetChar(mtype){
		var nt=document.getElementById('Char').value
		var J = new userobject(nt); 
		var hp;
		var df;
		var atk;
		var a=[0,0,0,0,0,0,0];
		var fileexist=true
		var weapont
		res=""
		res1=""
		res2=""
		res3=""
		res4=""
		res5=""
		//武器类型point
		var it2=[' 宵宫 安柏 达达利亚 迪奥娜 菲谢尔 甘雨 九条裟罗 埃洛伊 温迪 五郎 夜兰 ',' 芭芭拉 可莉 丽莎 莫娜 凝光 砂糖 烟绯 珊瑚宫心海 八重神子 ',' 魈 雷电将军 胡桃 罗莎莉亚 香菱 钟离 托马 申鹤 云堇 ',' 北斗 迪卢克 雷泽 诺艾尔 优菈 早柚 重云 辛焱 荒泷一斗 ',' 阿贝多 神里绫华 班尼特 凯亚 刻晴 枫原万叶 七七 琴 行秋 风旅行者 岩旅行者 雷旅行者 神里绫人 久岐忍 '];
			for (var i =0;i<=4; i++) {
				if (it2[i].indexOf(" "+document.getElementById('Char').value+" ")>=0){
					weapont=i
					break;
				}
			}	
		if (mtype==2){
			fileexist=Load()
			//武器库point
			var it=['<select id="Weapon" onchange="SetWeapon()"><option value="0">选择武器<\/option><option value="674">天空之翼<\/option><option value="608">阿莫斯/冬极/飞雷/终末<\/option><option value="542">若水<\/option><option value="565">祭礼弓/暗巷猎手/落霞<\/option><option value="510">弓藏/绿弓/风花/绝弦/试作<\/option><option value="454">西风猎弓/钢轮弓/破魔之弓<\/option><\/select>','<select id="Weapon" onchange="SetWeapon()"><option value="0">选择武器<\/option><option value="674">天空之卷<\/option><option value="608">神乐/尘锁/四风/月华<\/option><option value="565">白辰/万国/暗巷<\/option><option value="510">试作/匣里/西风<\/option><option value="454">祭礼残章/嘟嘟可故事集<\/option><\/select>','<select id="Weapon" onchange="SetWeapon()"><option value="0">选择武器<\/option><option value="741">息灾<\/option><option value="674">和璞鸢/天空之脊<\/option><option value="608">薙草/护摩/贯虹<\/option><option value="620">断浪长鳍<\/option><option value="565">西风/千岩/流月针<\/option><option value="510">渔获<\/option><option value="454">决斗之枪/匣里灭辰<\/option><\/select>','<select id="Weapon" onchange="SetWeapon()"><option value="0">选择武器<\/option><option value="741">松籁响起之时<\/option><option value="674">天空之傲<\/option><option value="608">无工之剑/狼的末路<\/option><option value="542">赤角石溃杵<\/option><option value="565">雪葬的星银/试作古华<\/option><option value="510">白影/螭骨/千岩/恶王丸<\/option><option value="454">西风大剑/衔珠海皇<\/option><\/select>','<select id="Weapon" onchange="SetWeapon()"><option value="0">选择武器<\/option><option value="674">风鹰剑/雾切之回光<\/option><option value="608">波乱/斫峰/苍古/天空<\/option><option value="542">磐岩结绿<\/option><option value="620">暗巷闪光<\/option><option value="565">试作斩岩<\/option><option value="510">腐殖/黑剑/铁蜂刺/匣里<\/option><option value="454">纺锤/天目/祭礼/西风<\/option><option value="401">黎明神剑<\/option><\/select>'];
			document.getElementById('WeaponList').innerHTML=it[weapont]
		}
		
		if (document.getElementById('Level').value=="1"){
			hp=J.lv80a["baseHP"]
			df=J.lv80a["baseDEF"]
			atk=J.lv80a["baseATK"]+GetE("QQ")
			res3="80突破"+document.getElementById('Char').value+"，"
			}
		else{
			hp=J.lv90["baseHP"]
			df=J.lv90["baseDEF"]
			atk=J.lv90["baseATK"]+GetE("QQ")
			res3="90级"+document.getElementById('Char').value+"，"
		}
		
		for (var i =1;i<=3; i++) {
			a[document.getElementById('A'+i.toString()).value-1]=a[document.getElementById('A'+i.toString()).value-1]+1
			switch(document.getElementById('A'+i.toString()).value-1){
				case 0:
					res4=res4+"生";
					break;
				case 1:
					res4=res4+"攻";
					break;
				case 2:
					res4=res4+"防";
					break;
				case 3:
					res4=res4+"精";
					break;
				case 4:
					res4=res4+"充";
					break;
				case 5:
					res4=res4+"暴";
					break;
				case 6:
					res4=res4+"爆";
					break;
				case 7:
					res4=res4+"伤";
					break;
				case 8:
					res4=res4+"治";
					break;	
			default:
				break;
			}
		}
		r[0]=((GetE("T1")-4780)/hp-0.466*a[0])/0.05	//生命
		r[1]=((GetE("T2")-311)/atk-0.466*a[1])/0.05	//攻击
		r[2]=(GetE("T3")/df-0.583*a[2])/0.062		//防御
		r[3]=(GetE("T4")-187*a[3])/19.75			//精通
		r[5]=(GetE("T5")-31.1*a[5])/3.3				//暴击
		r[6]=(GetE("T6")-62.2*a[6])/6.6				//爆伤
		r[4]=(GetE("T7")-51.8*a[4])/5.5				//充能

		
		var temppp=GetE("T5")*2+GetE("T6")
		res3=res3+"主词条"+res4+"，双暴"+temppp.toFixed(1).toString()+"分"
		
		if(r[0]+r[1]+r[2]+r[3]+r[4]+r[5]+r[6] > 53){res=res+"<p><font size='1' color='red'>*疑似错误地输入了人物面板而非圣遗物面板<\/font><\/p>"}
		
		for (var i =1;i<=6; i++) {
			if(r[i]<0){res=res+"<p><font size='1' color='red'>*圣遗物主属性或数据填写可能有误<\/font><\/p><p><font size='1' color='red'>（使用四星或未满级圣遗物时请无视）<\/font><\/p>";i=7}
		}
		
		if(GetE("QQ")>741 || GetE("QQ")<=0){res=res+"<p><font size='1' color='red'>*武器攻击力白值数据填写可能有误<\/font><\/p>"}
		
		if(J.mode!=6 && J.mode!=7 && J.mode!=13 && J.mode!=14 && J.mode!=16 && J.mode!=18 && J.mode!=21){res1=res1+"<p>攻双爆：共<font size='4'>"+(r[5]+r[1]+r[6]).toFixed(1).toString()+"<\/font>词条<\/p>"}
		//胡桃、诺埃尔、雷电将军、珊瑚宫心海、五郎、八重神子、夜兰不显示默认的这一条
		var tempshowload

		switch(J.mode){
			case 0://一般通用
			{tempshowload="0100110"}
				break;
			case 1://火水冰通用
			res1=res1+"<p>攻精双爆：共<font size='4'>"+(r[5]+r[1]+r[6]+r[3]).toFixed(1).toString()+"<\/font>词条<\/p>"
			{tempshowload="0101110"}
				break;
			case 2://火水冰充能工具人通用
			res1=res1+"<p>攻精双爆：共<font size='4'>"+(r[5]+r[1]+r[6]+r[3]).toFixed(1).toString()+"<\/font>词条<\/p>"
			res1=res1+"<p>攻精充双爆：共<font size='4'>"+(r[5]+r[1]+r[6]+r[3]+r[4]).toFixed(1).toString()+"<\/font>词条<\/p>"
			{tempshowload="0101111"}
				break;
			case 3://一般充能工具人通用
			res1=res1+"<p>攻充双爆：共<font size='4'>"+(r[5]+r[1]+r[6]+r[4]).toFixed(1).toString()+"<\/font>词条<\/p>"
			{tempshowload="0100111"}
				break;
			case 4://阿贝多
			res1=res1+"<p>防双爆：共<font size='4'>"+(r[5]+r[2]+r[6]).toFixed(1).toString()+"<\/font>词条<\/p>"
			{tempshowload="0010110"}
				break;
			case 5://钟离
			res1=res1+"<p>攻生双爆：共<font size='4'>"+(r[5]+r[1]+r[0]+r[6]).toFixed(1).toString()+"<\/font>词条<\/p>"
			res1=res1+"<p>攻生充双爆：共<font size='4'>"+(r[5]+r[1]+r[0]+r[4]+r[6]).toFixed(1).toString()+"<\/font>词条<\/p>"
			{tempshowload="1100111"}
				break;
			case 6://胡桃
			res1=res1+"<p>生精爆伤：共<font size='4'>"+(r[0]+r[3]+r[6]).toFixed(1).toString()+"<\/font>词条<\/p>"
			res1=res1+"<p>生精双爆：共<font size='4'>"+(r[0]+r[3]+r[5]+r[6]).toFixed(1).toString()+"<\/font>词条<\/p>"
			res1=res1+"<p>攻生精双爆（攻击按0.4折算）：共<font size='4'>"+(r[0]+r[3]+r[5]+r[6]+r[1]*0.4).toFixed(1).toString()+"<\/font>词条<\/p>"
			{tempshowload="1101110"}
				break;
			case 7://诺艾尔、一斗
			res1=res1+"<p>防双爆：共<font size='4'>"+(r[2]+r[6]+r[5]).toFixed(1).toString()+"<\/font>词条<\/p>"
			res1=res1+"<p>攻防双爆（攻击按0.4折算）：共<font size='4'>"+(r[1]*0.4+r[2]+r[6]+r[5]).toFixed(1).toString()+"<\/font>词条<\/p>"
			res1=res1+"<p>攻防充双爆（攻击按0.4折算）：共<font size='4'>"+(r[1]*0.4+r[2]+r[4]+r[6]+r[5]).toFixed(1).toString()+"<\/font>词条<\/p>"
			{tempshowload="0110111"}
				break;
			case 8://生命值奶妈
			res1=res1+"<p>生充：共<font size='4'>"+(r[0]+r[4]).toFixed(1).toString()+"<\/font>词条<\/p>"
			{tempshowload="1000001"}
				break;
			case 9://砂糖
			res1=res1+"<p>精：共<font size='4'>"+(r[3]).toFixed(1).toString()+"<\/font>词条<\/p>"
			{tempshowload="0001000"}
				break;
			case 10://优菈和神里
			res1=res1+"<p>攻充双爆：共<font size='4'>"+(r[5]+r[1]+r[6]+r[4]).toFixed(1).toString()+"<\/font>词条<\/p>"
			{tempshowload="0100111"}
				break;
			case 11://温迪
			res1=res1+"<p>攻精充双爆：共<font size='4'>"+(r[5]+r[1]+r[6]+r[4]+r[3]).toFixed(1).toString()+"<\/font>词条<\/p>"
			{tempshowload="0101111"}
				break;
			case 12://万叶
			res1=res1+"<p>精充：共<font size='4'>"+(r[3]+r[4]).toFixed(1).toString()+"<\/font>词条<\/p>"
			res1=res1+"<p>攻精双爆：共<font size='4'>"+(r[5]+r[1]+r[6]+r[3]).toFixed(1).toString()+"<\/font>词条<\/p>"
			{tempshowload="0101111"}
				break;
			case 13://雷电将军
			res1=res1+"<p>攻充双爆：共<font size='4'>"+(r[5]+r[1]+r[6]+r[4]).toFixed(1).toString()+"<\/font>词条<\/p>"
			{tempshowload="0100111"}
				break;
			case 14://珊瑚宫心海
			res1=res1+"<p>生充：共<font size='4'>"+(r[0]+r[4]).toFixed(1).toString()+"<\/font>词条<\/p>"
			res1=res1+"<p>攻生充（攻击按0.4折算）：共<font size='4'>"+(r[0]+r[1]*0.4+r[4]).toFixed(1).toString()+"<\/font>词条<\/p>"
			res1=res1+"<p>攻生精充（攻击按0.4折算）：共<font size='4'>"+(r[0]+r[1]*0.4+r[3]+r[4]).toFixed(1).toString()+"<\/font>词条<\/p>"
			{tempshowload="1000001"}
				break;
			case 15://托马
			res1=res1+"<p>生充：共<font size='4'>"+(r[0]+r[4]).toFixed(1).toString()+"<\/font>词条<\/p>"
			{tempshowload="1000001"}
				break;	
			case 16://五郎、云堇
			res1=res1+"<p>防充：共<font size='4'>"+(r[2]+r[4]).toFixed(1).toString()+"<\/font>词条<\/p>"
			{tempshowload="0010001"}
				break;	
			case 17://申鹤
			res1=res1+"<p>攻充：共<font size='4'>"+(r[1]+r[4]).toFixed(1).toString()+"<\/font>词条<\/p>"
			{tempshowload="0100001"}
			break;	
			case 18://八重
			res1=res1+"<p>攻精双爆：共<font size='4'>"+(r[5]+r[1]+r[3]+r[6]).toFixed(1).toString()+"<\/font>词条<\/p>"
			res1=res1+"<p>攻精充双爆：共<font size='4'>"+(r[5]+r[1]+r[3]+r[4]+r[6]).toFixed(1).toString()+"<\/font>词条<\/p>"
			{tempshowload="0101111"}
			break;	
			case 19://雷旅行者
			res1=res1+"<p>充：共<font size='4'>"+(r[4]).toFixed(1).toString()+"<\/font>词条<\/p>"
			res1=res1+"<p>攻充双爆：共<font size='4'>"+(r[5]+r[1]+r[4]+r[6]).toFixed(1).toString()+"<\/font>词条<\/p>"
			{tempshowload="0100111"}
			break;	
			case 20://绫人
			res1=res1+"<p>攻生双爆（生命按0.5折算）：共<font size='4'>"+(r[5]+r[1]+r[0]*0.5+r[6]).toFixed(1).toString()+"<\/font>词条<\/p>"
			{tempshowload="1100110"}
			break;
			case 21://夜兰
			res1=res1+"<p>生双爆：共<font size='4'>"+(r[5]+r[0]+r[6]).toFixed(1).toString()+"<\/font>词条<\/p>"
			res1=res1+"<p>生充双爆：共<font size='4'>"+(r[5]+r[0]+r[4]+r[6]).toFixed(1).toString()+"<\/font>词条<\/p>"
			{tempshowload="1000111"}
			break;
			case 22://久岐忍
			res1=res1+"<p>生：共<font size='4'>"+(r[0]).toFixed(1).toString()+"<\/font>词条<\/p>"
			res1=res1+"<p>生精：共<font size='4'>"+(r[0]+r[3]).toFixed(1).toString()+"<\/font>词条<\/p>"
			{tempshowload="1001000"}
			break;
			case 23://辛焱
			res1=res1+"<p>攻防双爆：共<font size='4'>"+(r[1]+r[2]+r[5]+r[6]).toFixed(1).toString()+"<\/font>词条<\/p>"
			{tempshowload="0110110"}
			break;

			default:
				break;
		}

		switch(J.Etype){
			case 1:
				res5="#66CDAA"
				break;
			case 2:
				res5="#1E90FF"
				break;
			case 3:
				res5="#DC143C"
				break;
			case 4:
				res5="#00BFFF"
				break;
			case 5:
				res5="#8A2BE2"
				break;
			case 6:
				res5="#DAA520"
				break;	
			default:
				break;
		}

		if (ShowLoad=="" || ShowLoad==undefined){
			ShowLoad=tempshowload
		}else{
			tempshowload=ShowLoad
		}
		var temp6=0
		for (var i =0;i<=6; i++) {
			var j=i
			if (j==4){j=5}
			else if (j==5){j=6}
			else if (j==6){j=4}

			if(tempshowload[i]=='1'){
				cc[i]="'"+res5+"'> <b"
					var temp7=checkname(nt)
					if(temp7>0){
						if(j==lastcheck){
							temp6+=r[j]*temp7
						}else{
							temp6+=r[j]
						}
					}else{
						temp6+=r[j]
					}
				//cc[i]="'"+"#2d0c13"+"'> <b"
			}else{
				cc[i]="'#b598a1'"
			}
		}
		temp6=temp6.toFixed(1)
		if(res1.indexOf(naturecall(tempshowload))<0){
			var tempgg=checkname(nt)
			res1="<p>"+naturecall(tempshowload)+"（自定义"+ ((tempgg>0 && tempshowload[lastcheck]=="1")?"，"+lastcheckstr+"按"+tempgg.toFixed(1)+"折算":"")  +"）：共<font size='4'>"+temp6.toString()+"<\/font>词条<\/p>"+res1
		}
		res1=res1.replace(/（/g, "<font size='2'>（")
		res1=res1.replace(/）/g, "）<\/font>")		
		
		res=res+"<p><font size='2' color="+cc[0]+">生 "+r[0].toFixed(1).toString()+"<\/b><\/font> | <font size='2' color="+cc[1]+">攻 "+r[1].toFixed(1).toString()+"<\/b><\/font> | <font size='2' color="+cc[2]+">防 "+r[2].toFixed(1).toString()+"<\/b><\/font><\/p>"
		res=res+"<p><font size='2' color="+cc[3]+">精 "+r[3].toFixed(1).toString()+"<\/b><\/font> | <font size='2' color="+cc[6]+">充 "+r[4].toFixed(1).toString()+"<\/b><\/font> | <font size='2' color="+cc[4]+">暴 "+r[5].toFixed(1).toString()+"<\/b><\/font> | <font size='2' color="+cc[5]+">爆 "+r[6].toFixed(1).toString()+"<\/b><\/font><\/p>"

		document.getElementById('result2').innerHTML="<font size='3' color='"+res5+"'><b>"+res3+"<\/b><\/font>"
		if(GetE("QQ")==542 && (weapont==4)){
			res2=res2+"<p><font size='2'>——磐岩结绿附加攻击——<\/font><\/p>"
			res2=res2+"<p><font size='2'>1精：共"+(r[0]*0.218402778).toFixed(1).toString()+"词条<\/p>"
			res2=res2+"<p><font size='2'>2精：共"+(r[0]*0.273003472).toFixed(1).toString()+"词条<\/p>"
			res2=res2+"<p><font size='2'>3精：共"+(r[0]*0.327604167).toFixed(1).toString()+"词条<\/p>"
			res2=res2+"<p><font size='2'>4精：共"+(r[0]*0.382204861).toFixed(1).toString()+"词条<\/p>"
			res2=res2+"<p><font size='2'>5精：共"+(r[0]*0.436805556).toFixed(1).toString()+"词条<\/p>"
		}
		
		if(fileexist){
			document.getElementById('result').innerHTML=res+res1+res2
			if(onloading!=true && mtype!=0){window.location.href='#anchor'}
		}else{
			document.getElementById('result2').innerHTML=""
			document.getElementById('result').innerHTML="暂无结果"
		}
		
		if (mtype==0){
			Save(document.getElementById('Char').value)
		}
		
		if(mtype==1){
			res1=res1.replace(/：/g, "")
			res1=res1.replace(/<\/p><p>/g, "，")
			res1=res1.replace(/<p>/g, "")
			res1=res1.replace(/<\/p>/g, "")
			res1=res1.replace(/<font size='4'>/g, "")
			res1=res1.replace(/<font size='2'>/g, "")
			res1=res1.replace(/<\/font>/g, "")
			res1=res1.replace(/主词条>/g, "主词条为")
			res3=res3+"，"+res1
			
			return(copytxt(res3))
		}
}

function GetE(n){
	return parseFloat(document.getElementById(n).value)
}

 window.onload = function () {
		onloading=true
		Load()
		var tempc=window.localStorage.getItem("ysbjjsq")
		SetCharL()
		onloading=false
		charcache=document.getElementById("Char")

		//var tempc=window.localStorage.getItem("ysbjjsq")
		console.log(tempc)
		//tempc="神里绫人"
		for (var i =0;i<=charcache.options.length-1;i++) {
			if(charcache.options[i].value==tempc){
				document.getElementById("Char").options[i].selected=true;
				SetCharL();
			}
		}
	}
		
function copytxt(txt){
    var input = document.createElement('input');
    input.setAttribute('readonly', 'readonly'); 
    input.setAttribute('value', txt);
    document.body.appendChild(input);
    input.select();
    var res = document.execCommand('copy');
    document.body.removeChild(input);
    return res;
}

function SetWeapon(){
	var temp=document.getElementById("Weapon").value
	if(temp!="0"){
		document.getElementById("QQ").value=temp
		Save(document.getElementById('Char').value)
		SetChar(0)
	}
}

function ShowPage2(mode){
	var temp=charcache
	var temphtml=""
	for (var i =0;i<=temp.options.length-1;i++) {
		n=window.localStorage.getItem("ys"+temp.options[i].value)
		if(n!=null){
			var temp2=n.split("/");
			if (temp2[19]!="" && temp2[19]!=undefined){
				var J1 = new userobject(temp.options[i].value); 
				var res5=""
				switch(J1.Etype){
					case 1:
						res5="#66CDAA"
						break;
					case 2:
						res5="#1E90FF"
						break;
					case 3:
						res5="#DC143C"
						break;
					case 4:
						res5="#00BFFF"
						break;
					case 5:
						res5="#8A2BE2"
						break;
					case 6:
						res5="#DAA520"
						break;	
					default:
						break;
				}
				if(mode==2){
					temphtml+="<tr align='center'><td><p id='name"+i.toString()+"'><font color='"+res5+"'>"+temp.options[i].value+'<\/font><\/p><\/td>'+'<td><p id="result'+i.toString()+'">100<\/p><\/td>'+'<td class="td-3"><input onchange="update()"'+(temp2[19][0]=="1"?'checked=""' : "")+' type="checkbox" value="'+temp2[12]+'" id="check'+i.toString()+'1" \\\\/>生'+temp2[12]+" "
					temphtml+='<input onchange="update()"'+(temp2[19][1]=="1"?'checked=""' : "")+' type="checkbox" value="'+temp2[13]+'" id="check'+i.toString()+'2" \\\\/>攻'+temp2[13]+" "
					temphtml+='<input onchange="update()"'+(temp2[19][2]=="1"?'checked=""' : "")+' type="checkbox" value="'+temp2[14]+'" id="check'+i.toString()+'3" \\\\/>防'+temp2[14]+" "
					temphtml+='<input onchange="update()"'+(temp2[19][3]=="1"?'checked=""' : "")+' type="checkbox" value="'+temp2[15]+'" id="check'+i.toString()+'4" \\\\/>精'+temp2[15]+" "
					temphtml+='<input onchange="update()"'+(temp2[19][4]=="1"?'checked=""' : "")+' type="checkbox" value="'+temp2[16]+'" id="check'+i.toString()+'5" \\\\/>暴'+temp2[16]+" "
					temphtml+='<input onchange="update()"'+(temp2[19][5]=="1"?'checked=""' : "")+' type="checkbox" value="'+temp2[17]+'" id="check'+i.toString()+'6" \\\\/>爆'+temp2[17]+" "
					temphtml+='<input onchange="update()"'+(temp2[19][6]=="1"?'checked=""' : "")+' type="checkbox" value="'+temp2[18]+'" id="check'+i.toString()+'7" \\\\/>充'+temp2[18]+" <\/tr>"
				}else{
					var temp3=0
					var temp4=""
					var temp5=""
					for (var j =1;j<=7;j++) {
						if(temp2[19][j-1]=="1"){
							var nt=temp.options[i].value
							var temp8=checkname(nt)
							if(temp8>0){
								if((j-1)==lastcheck){
									temp3+=parseFloat(temp2[11+j])*temp8
								}else{
									temp3+=parseFloat(temp2[11+j])
								}
							}else{
								temp3+=parseFloat(temp2[11+j])
							}
						}
					}
					temp4=naturecall(temp2[19])
					for (var j =1;j<=3;j++) {
						switch(parseInt(temp2[8+j])){
							case 1:
								temp5+="生"
								break;
							case 2:
								temp5+="攻"
								break;
							case 3:
								temp5+="防"
								break;
							case 4:
								temp5+="精"
								break;
							case 5:
								temp5+="充"
								break;
							case 6:
								temp5+="暴"
								break;	
							case 7:
								temp5+="爆"
								break;					
							case 8:
								temp5+="伤"
								break;
							case 9:
								temp5+="治"
								break;
							default:
								break;
						}
					}
					temp3=temp3.toFixed(1)
					

					var tempstr='window.localStorage.setItem("ysbjjsq","'+temp.options[i].value+'");location.reload()'
					temphtml+="<tr align='center'><td><p id='name"+i.toString()+"' onclick="+tempstr+"><font color='"+res5+"'>"+temp.options[i].value+'<\/font><\/p><\/td>'+'<td><p id="result'+i.toString()+'">'+temp3.toString()+'条<\/p><\/td>'+'<td >'+(parseFloat(temp2[6])*2+parseFloat(temp2[7])).toFixed(1).toString()+'分<\/td><td>'+temp4+'<\/td><td><b>'+temp5+'<\/b><\/td><\/tr>'
				}
			}
		}
	}
	if (mode==2){
		document.getElementById("page1").innerHTML='<table border="1" align="center" class="gridtable"><tr><th>角色<\/th><th>共计<\/th><th>选择有效词条<\/th><\/tr>'+temphtml+'<\/table>'
		document.getElementById("buttonlabel").innerHTML='<p align="center" class="tip"><font size="2">*在本地计算过的不同的角色的结果（仅限方案1）会以列表形式显示在此，可自行选择对你来说有效的词条<\/font><\/p><p align="center"><button type="button" class="red" onclick="window.location.href=\'\'" ><--返回<\/button> <button type="button" onclick="ShowPage2(1)" class="blue">显示更多结果<\/button><\/p>'
		//window.location.href='#page1'
		update()
	}else{
		document.getElementById("page1").innerHTML='<table border="1" align="center" class="gridtable"><tr><th>角色<\/th><th>共计<\/th><th>双爆<\/th><th>使用副词条<\/th><th>主词条<\/th><\/tr>'+temphtml+'<\/table>'
		document.getElementById("buttonlabel").innerHTML='<p align="center" class="tip"><font size="2">*在本地计算过的不同的角色的结果（仅限方案1）会以列表形式显示在此，可自行选择对你来说有效的词条<\/font><\/p><p align="center"><button type="button" class="red" onclick="window.location.href=\'\'" ><--返回<\/button> <button type="button" onclick="ShowPage2(2)" class="blue">选择有效词条<\/button><\/p>'
		//window.location.href='#page1'
	}
}

function update(){
	for (var i =0;i<=1000;i++) {
		var temp=document.getElementById("result"+i.toString())
		if(temp!=null){
		var sum=0
		var it=""
			for (var j =1;j<=7;j++) {
				if(document.getElementById("check"+i.toString()+j.toString()).checked){
					var nt=charcache.options[i].value
					var temp8=checkname(nt)
					if(temp8>0){
						if(j==(lastcheck+1)){
							sum=sum+parseFloat(document.getElementById("check"+i.toString()+j.toString()).value)*temp8
						}else{
							sum=sum+parseFloat(document.getElementById("check"+i.toString()+j.toString()).value)
						}
					}else{
						sum=sum+parseFloat(document.getElementById("check"+i.toString()+j.toString()).value)
					}
					it+="1"
				}else{
					it+="0"
				}
			}
			temp.innerHTML=sum.toFixed(1)
			n=window.localStorage.getItem("ys"+document.getElementById("name"+i.toString()).innerText)
			var temp2=n.split("/");
			temp2[19]=it
			it=""
			for (var j =0;j<=19;j++) {
				it+=temp2[j]+"/"
			}
			window.localStorage.setItem("ys"+document.getElementById("name"+i.toString()).innerText,it)
		}
	}
}

function naturecall(s){
	var answer=''
					if(s[1]=="1"){answer+="攻"}
					if(s[0]=="1"){answer+="生"}
					if(s[2]=="1"){answer+="防"}
					if(s[3]=="1"){answer+="精"}
					if(s[6]=="1"){answer+="充"}
					if(s[4]=="1"){answer+="暴"}
					if(s[5]=="1"){answer+="爆"}
					answer=answer.replace(/暴爆/g, "双爆")
	return answer;
}

//折算point
function checkname(n){
	if(n=="胡桃" || n=="诺艾尔" || n=="荒泷一斗" || n=="珊瑚宫心海"){
		lastcheck=1;
		lastcheckstr="攻击"
		return 0.4
	}
	if(n=="神里绫人"){
		lastcheck=0;
		lastcheckstr="生命"
		return 0.5
	}
		lastcheck=-1;
		lastcheckstr=""
		return -1
}

function info(){
	alert("使用方法：\n1、选好角色和等级(80突破以下直接使用80突破即可)\n2、然后选择好沙漏、杯子和帽子的主词条\n3、填写（或选择）武器的攻击力白值\n4、游戏内点开角色→圣遗物→圣遗物详情按钮，在表格中依次填入对应项目的数值")
}
</script>


<!----><!----><remove-web-limits-iqxin id=rwl-iqxin class=rwl-exempt style="position: fixed; top: 95px; left: 0px;"><qxinbutton type=qxinbutton id=rwl-setbtn> set </qxinbutton> <lalala style="cursor:move; font-size:12px;">限制解除</lalala> <input type=checkbox name id=black_node></remove-web-limits-iqxin><script data-template-shadow-root>(() => { document.currentScript.remove(); const processNode = node => { node.querySelectorAll("template[shadowroot]").forEach(element=>{ let shadowRoot = getShadowRoot(element.parentElement); if (!shadowRoot) { try { shadowRoot = element.parentElement.attachShadow({mode:element.getAttribute("shadowroot")}); shadowRoot.innerHTML = element.innerHTML; element.remove(); } catch (error) {} if (shadowRoot) { processNode(shadowRoot); } } }) }; const FORBIDDEN_TAG_NAMES = ["a","area","audio","base","br","col","command","embed","hr","img","iframe","input","keygen","link","meta","param","source","track","video","wbr"]; const NOTE_TAGNAME = "single-file-note"; const NOTE_CLASS = "note"; const NOTE_ANCHORED_CLASS = "note-anchored"; const NOTE_SELECTED_CLASS = "note-selected"; const NOTE_MOVING_CLASS = "note-moving"; const NOTE_MASK_MOVING_CLASS = "note-mask-moving"; const MASK_CLASS = "single-file-mask"; const HIGHLIGHT_CLASS = "single-file-highlight"; const NOTES_WEB_STYLESHEET = ".note { all: initial; display: flex; flex-direction: column; height: 150px; width: 150px; position: absolute; top: 10px; left: 10px; border: 1px solid rgb(191, 191, 191); z-index: 2147483646; box-shadow: 3px 3px 3px rgba(33, 33, 33, .7); min-height: 100px; min-width: 100px; } .note-selected { z-index: 2147483647; } .note-hidden { display: none; } .note-collapsed { min-height: 30px; max-height: 30px; overflow: hidden; } .note textarea { all: initial; white-space: break-spaces; font-family: Arial, Helvetica, sans-serif; font-size: 14px; padding: 3px; height: 100%; border: 1px solid transparent; resize: none; color: black; } .note textarea:focus { border: 1px dotted rgb(160, 160, 160); } .note header { all: initial; min-height: 30px; cursor: grab; user-select: none; } .note .note-remove { all: initial; position: absolute; right: 0px; top: 2px; padding: 5px; opacity: .5; cursor: pointer; user-select: none; width: 16px; height: 16px; } .note .note-anchor { all: initial; position: absolute; left: 0px; top: 2px; padding: 5px; opacity: .25; cursor: pointer; width: 16px; height: 16px; } .note .note-resize { all: initial; position: absolute; bottom: -5px; right: -5px; height: 15px; width: 15px; cursor: nwse-resize; user-select: none; } .note .note-remove:hover { opacity: 1; } .note .note-anchor:hover { opacity: .5; } .note-anchored .note-anchor { opacity: .5; } .note-anchored .note-anchor:hover { opacity: 1; } .note-moving { opacity: .75; box-shadow: 6px 6px 3px rgba(33, 33, 33, .7); } .note-moving * { cursor: grabbing; } .note-yellow header { background-color: #f5f545; } .note-yellow textarea { background-color: #ffff7c; } .note-pink header { background-color: #ffa59f; } .note-pink textarea { background-color: #ffbbb6; } .note-blue header { background-color: #84c8ff; } .note-blue textarea { background-color: #95d0ff; } .note-green header { background-color: #93ef8d; } .note-green textarea { background-color: #9cff95; }"; const MASK_WEB_STYLESHEET = ".note-mask { all: initial; position: fixed; z-index: 2147483645; pointer-events: none; background-color: transparent; transition: background-color 125ms; } .note-mask-moving.note-yellow { background-color: rgba(255, 255, 124, .3); } .note-mask-moving.note-pink { background-color: rgba(255, 187, 182, .3); } .note-mask-moving.note-blue { background-color: rgba(149, 208, 255, .3); } .note-mask-moving.note-green { background-color: rgba(156, 255, 149, .3); } .page-mask { all: initial; position: fixed; top: 0; left: 0; width: 0; height: 0; z-index: 2147483646; } .page-mask-active { width: 100vw; height: 100vh; }"; const NOTE_HEADER_HEIGHT = 25; const PAGE_MASK_ACTIVE_CLASS = "page-mask-active"; const REMOVED_CONTENT_CLASS = "single-file-removed"; const reflowNotes = function reflowNotes() { document.querySelectorAll(NOTE_TAGNAME).forEach(containerElement => { const noteElement = containerElement.shadowRoot.querySelector("." + NOTE_CLASS); const noteBoundingRect = noteElement.getBoundingClientRect(); const anchorElement = getAnchorElement(containerElement); const anchorBoundingRect = anchorElement.getBoundingClientRect(); const maxX = anchorBoundingRect.x + Math.max(0, anchorBoundingRect.width - noteBoundingRect.width); const minX = anchorBoundingRect.x; const maxY = anchorBoundingRect.y + Math.max(0, anchorBoundingRect.height - NOTE_HEADER_HEIGHT); const minY = anchorBoundingRect.y; let left = parseInt(noteElement.style.getPropertyValue("left")); let top = parseInt(noteElement.style.getPropertyValue("top")); if (noteBoundingRect.x > maxX) { left -= noteBoundingRect.x - maxX; } if (noteBoundingRect.x < minX) { left += minX - noteBoundingRect.x; } if (noteBoundingRect.y > maxY) { top -= noteBoundingRect.y - maxY; } if (noteBoundingRect.y < minY) { top += minY - noteBoundingRect.y; } noteElement.style.setProperty("position", "absolute"); noteElement.style.setProperty("left", left + "px"); noteElement.style.setProperty("top", top + "px"); }); }; const addNoteRef = function addNoteRef(anchorElement, noteId) { const noteRefs = getNoteRefs(anchorElement); noteRefs.push(noteId); setNoteRefs(anchorElement, noteRefs); }; const deleteNoteRef = function deleteNoteRef(containerElement, noteId) { const anchorElement = getAnchorElement(containerElement); const noteRefs = getNoteRefs(anchorElement).filter(noteRefs => noteRefs != noteId); if (noteRefs.length) { setNoteRefs(anchorElement, noteRefs); } else { delete anchorElement.dataset.singleFileNoteRefs; } }; const getNoteRefs = function getNoteRefs(anchorElement) { return JSON.parse("[" + (anchorElement.dataset.singleFileNoteRefs || "") + "]"); }; const setNoteRefs = function setNoteRefs(anchorElement, noteRefs) { anchorElement.dataset.singleFileNoteRefs = noteRefs.toString(); }; const getAnchorElement = function getAnchorElement(containerElement) { return document.querySelector("[data-single-file-note-refs^=" + JSON.stringify(containerElement.dataset.noteId) + "], [data-single-file-note-refs$=" + JSON.stringify(containerElement.dataset.noteId) + "], [data-single-file-note-refs*=" + JSON.stringify("," + containerElement.dataset.noteId + ",") + "]") || document.documentElement; }; const getMaskElement = function getMaskElement(className, containerClassName) { let maskElement = document.documentElement.querySelector("." + className); if (!maskElement) { maskElement = document.createElement("div"); const maskContainerElement = document.createElement("div"); if (containerClassName) { maskContainerElement.classList.add(containerClassName); } maskContainerElement.classList.add(MASK_CLASS); const firstNote = document.querySelector(NOTE_TAGNAME); if (firstNote && firstNote.parentElement == document.documentElement) { document.documentElement.insertBefore(maskContainerElement, firstNote); } else { document.documentElement.appendChild(maskContainerElement); } maskElement.classList.add(className); const maskShadow = maskContainerElement.attachShadow({ mode: "open" }); maskShadow.appendChild(getStyleElement(MASK_WEB_STYLESHEET)); maskShadow.appendChild(maskElement); return maskElement; } }; const getStyleElement = function getStyleElement(stylesheet) { const linkElement = document.createElement("style"); linkElement.textContent = stylesheet; return linkElement; }; const attachNoteListeners = function attachNoteListeners(containerElement, editable = false) { const SELECT_PX_THRESHOLD = 4; const COLLAPSING_NOTE_DELAY = 750; const noteShadow = containerElement.shadowRoot; const noteElement = noteShadow.childNodes[1]; const headerElement = noteShadow.querySelector("header"); const mainElement = noteShadow.querySelector("textarea"); const noteId = containerElement.dataset.noteId; const resizeElement = noteShadow.querySelector(".note-resize"); const anchorIconElement = noteShadow.querySelector(".note-anchor"); const removeNoteElement = noteShadow.querySelector(".note-remove"); mainElement.readOnly = !editable; if (!editable) { anchorIconElement.style.setProperty("display", "none", "important"); } else { anchorIconElement.style.removeProperty("display"); } headerElement.ontouchstart = headerElement.onmousedown = event => { if (event.target == headerElement) { collapseNoteTimeout = setTimeout(() => { noteElement.classList.toggle("note-collapsed"); hideMaskNote(); }, COLLAPSING_NOTE_DELAY); event.preventDefault(); const position = getPosition(event); const clientX = position.clientX; const clientY = position.clientY; const boundingRect = noteElement.getBoundingClientRect(); const deltaX = clientX - boundingRect.left; const deltaY = clientY - boundingRect.top; maskPageElement.classList.add(PAGE_MASK_ACTIVE_CLASS); document.documentElement.style.setProperty("user-select", "none", "important"); anchorElement = getAnchorElement(containerElement); displayMaskNote(); selectNote(noteElement); moveNote(event, deltaX, deltaY); movingNoteMode = { event, deltaX, deltaY }; document.documentElement.ontouchmove = document.documentElement.onmousemove = event => { clearTimeout(collapseNoteTimeout); if (!movingNoteMode) { movingNoteMode = { deltaX, deltaY }; } movingNoteMode.event = event; moveNote(event, deltaX, deltaY); }; } }; resizeElement.ontouchstart = resizeElement.onmousedown = event => { event.preventDefault(); resizingNoteMode = true; selectNote(noteElement); maskPageElement.classList.add(PAGE_MASK_ACTIVE_CLASS); document.documentElement.style.setProperty("user-select", "none", "important"); document.documentElement.ontouchmove = document.documentElement.onmousemove = event => { event.preventDefault(); const { clientX, clientY } = getPosition(event); const boundingRectNote = noteElement.getBoundingClientRect(); noteElement.style.width = clientX - boundingRectNote.left + "px"; noteElement.style.height = clientY - boundingRectNote.top + "px"; }; }; anchorIconElement.ontouchend = anchorIconElement.onclick = event => { event.preventDefault(); noteElement.classList.toggle(NOTE_ANCHORED_CLASS); if (!noteElement.classList.contains(NOTE_ANCHORED_CLASS)) { deleteNoteRef(containerElement, noteId); addNoteRef(document.documentElement, noteId); } onUpdate(false); }; removeNoteElement.ontouchend = removeNoteElement.onclick = event => { event.preventDefault(); deleteNoteRef(containerElement, noteId); containerElement.remove(); }; noteElement.onmousedown = () => { selectNote(noteElement); }; function moveNote(event, deltaX, deltaY) { event.preventDefault(); const { clientX, clientY } = getPosition(event); noteElement.classList.add(NOTE_MOVING_CLASS); if (editable) { if (noteElement.classList.contains(NOTE_ANCHORED_CLASS)) { deleteNoteRef(containerElement, noteId); anchorElement = getTarget(clientX, clientY) || document.documentElement; addNoteRef(anchorElement, noteId); } else { anchorElement = document.documentElement; } } document.documentElement.insertBefore(containerElement, maskPageElement.getRootNode().host); noteElement.style.setProperty("left", (clientX - deltaX) + "px"); noteElement.style.setProperty("top", (clientY - deltaY) + "px"); noteElement.style.setProperty("position", "fixed"); displayMaskNote(); } function displayMaskNote() { if (anchorElement == document.documentElement || anchorElement == document.documentElement) { hideMaskNote(); } else { const boundingRectAnchor = anchorElement.getBoundingClientRect(); maskNoteElement.classList.add(NOTE_MASK_MOVING_CLASS); if (selectedNote) { maskNoteElement.classList.add(selectedNote.dataset.color); } maskNoteElement.style.setProperty("top", (boundingRectAnchor.y - 3) + "px"); maskNoteElement.style.setProperty("left", (boundingRectAnchor.x - 3) + "px"); maskNoteElement.style.setProperty("width", (boundingRectAnchor.width + 3) + "px"); maskNoteElement.style.setProperty("height", (boundingRectAnchor.height + 3) + "px"); } } function hideMaskNote() { maskNoteElement.classList.remove(NOTE_MASK_MOVING_CLASS); if (selectedNote) { maskNoteElement.classList.remove(selectedNote.dataset.color); } } function selectNote(noteElement) { if (selectedNote) { selectedNote.classList.remove(NOTE_SELECTED_CLASS); maskNoteElement.classList.remove(selectedNote.dataset.color); } noteElement.classList.add(NOTE_SELECTED_CLASS); noteElement.classList.add(noteElement.dataset.color); selectedNote = noteElement; } function getTarget(clientX, clientY) { const targets = Array.from(document.elementsFromPoint(clientX, clientY)).filter(element => element.matches("html *:not(" + NOTE_TAGNAME + "):not(." + MASK_CLASS + ")")); if (!targets.includes(document.documentElement)) { targets.push(document.documentElement); } let newTarget, target = targets[0], boundingRect = target.getBoundingClientRect(); newTarget = determineTargetElement("floor", target, clientX - boundingRect.left, getMatchedParents(target, "left")); if (newTarget == target) { newTarget = determineTargetElement("ceil", target, boundingRect.left + boundingRect.width - clientX, getMatchedParents(target, "right")); } if (newTarget == target) { newTarget = determineTargetElement("floor", target, clientY - boundingRect.top, getMatchedParents(target, "top")); } if (newTarget == target) { newTarget = determineTargetElement("ceil", target, boundingRect.top + boundingRect.height - clientY, getMatchedParents(target, "bottom")); } target = newTarget; while (boundingRect = target && target.getBoundingClientRect(), boundingRect && boundingRect.width <= SELECT_PX_THRESHOLD && boundingRect.height <= SELECT_PX_THRESHOLD) { target = target.parentElement; } return target; } function getMatchedParents(target, property) { let element = target, matchedParent, parents = []; do { const boundingRect = element.getBoundingClientRect(); if (element.parentElement && !element.parentElement.tagName.toLowerCase() != NOTE_TAGNAME && !element.classList.contains(MASK_CLASS)) { const parentBoundingRect = element.parentElement.getBoundingClientRect(); matchedParent = Math.abs(parentBoundingRect[property] - boundingRect[property]) <= SELECT_PX_THRESHOLD; if (matchedParent) { if (element.parentElement.clientWidth > SELECT_PX_THRESHOLD && element.parentElement.clientHeight > SELECT_PX_THRESHOLD && ((element.parentElement.clientWidth - element.clientWidth > SELECT_PX_THRESHOLD) || (element.parentElement.clientHeight - element.clientHeight > SELECT_PX_THRESHOLD))) { parents.push(element.parentElement); } element = element.parentElement; } } else { matchedParent = false; } } while (matchedParent && element); return parents; } function determineTargetElement(roundingMethod, target, widthDistance, parents) { if (Math[roundingMethod](widthDistance / SELECT_PX_THRESHOLD) <= parents.length) { target = parents[parents.length - Math[roundingMethod](widthDistance / SELECT_PX_THRESHOLD) - 1]; } return target; } }; const anchorNote = function anchorNote(event, noteElement, deltaX, deltaY) { event.preventDefault(); const { clientX, clientY } = getPosition(event); document.documentElement.style.removeProperty("user-select"); noteElement.classList.remove(NOTE_MOVING_CLASS); maskNoteElement.classList.remove(NOTE_MASK_MOVING_CLASS); maskPageElement.classList.remove(PAGE_MASK_ACTIVE_CLASS); maskNoteElement.classList.remove(noteElement.dataset.color); const headerElement = noteElement.querySelector("header"); headerElement.ontouchmove = document.documentElement.onmousemove = null; let currentElement = anchorElement; let positionedElement; while (currentElement.parentElement && !positionedElement) { if (!FORBIDDEN_TAG_NAMES.includes(currentElement.tagName.toLowerCase())) { const currentElementStyle = getComputedStyle(currentElement); if (currentElementStyle.position != "static") { positionedElement = currentElement; } } currentElement = currentElement.parentElement; } if (!positionedElement) { positionedElement = document.documentElement; } const containerElement = noteElement.getRootNode().host; if (positionedElement == document.documentElement) { const firstMaskElement = document.querySelector("." + MASK_CLASS); firstMaskElement.parentElement.insertBefore(containerElement, firstMaskElement); } else { positionedElement.appendChild(containerElement); } const boundingRectPositionedElement = positionedElement.getBoundingClientRect(); const stylePositionedElement = window.getComputedStyle(positionedElement); const borderX = parseInt(stylePositionedElement.getPropertyValue("border-left-width")); const borderY = parseInt(stylePositionedElement.getPropertyValue("border-top-width")); noteElement.style.setProperty("position", "absolute"); noteElement.style.setProperty("left", (clientX - boundingRectPositionedElement.x - deltaX - borderX) + "px"); noteElement.style.setProperty("top", (clientY - boundingRectPositionedElement.y - deltaY - borderY) + "px"); }; const getPosition = function getPosition(event) { if (event.touches && event.touches.length) { const touch = event.touches[0]; return touch; } else { return event; } }; const onMouseUp = function onMouseUp(event) { if (highlightSelectionMode) { highlightSelection(); onUpdate(false); } if (removeHighlightMode) { let element = event.target, done; while (element && !done) { if (element.classList.contains(HIGHLIGHT_CLASS)) { document.querySelectorAll("." + HIGHLIGHT_CLASS + "[data-singlefile-highlight-id=" + JSON.stringify(element.dataset.singlefileHighlightId) + "]").forEach(highlightedElement => { resetHighlightedElement(highlightedElement); onUpdate(false); }); done = true; } element = element.parentElement; } } if (resizingNoteMode) { resizingNoteMode = false; document.documentElement.style.removeProperty("user-select"); maskPageElement.classList.remove(PAGE_MASK_ACTIVE_CLASS); document.documentElement.ontouchmove = document.documentElement.onmousemove = null; onUpdate(false); } if (movingNoteMode) { anchorNote(movingNoteMode.event || event, selectedNote, movingNoteMode.deltaX, movingNoteMode.deltaY); movingNoteMode = null; document.documentElement.ontouchmove = document.documentElement.onmousemove = null; onUpdate(false); } if (collapseNoteTimeout) { clearTimeout(collapseNoteTimeout); collapseNoteTimeout = null; } if ((cuttingMode || cuttingOuterMode) && cuttingPath) { if (event.ctrlKey) { const element = cuttingPath[cuttingPathIndex]; element.classList.toggle(cuttingMode ? CUT_SELECTED_CLASS : CUT_OUTER_SELECTED_CLASS); } else { validateCutElement(event.shiftKey); } } }; const getShadowRoot = function getShadowRoot(element) { const chrome = window.chrome; if (element.openOrClosedShadowRoot) { return element.openOrClosedShadowRoot; } else if (chrome && chrome.dom && chrome.dom.openOrClosedShadowRoot) { try { return chrome.dom.openOrClosedShadowRoot(element); } catch (error) { return element.shadowRoot; } } else { return element.shadowRoot; } }; const maskNoteElement = getMaskElement("note-mask"); const maskPageElement = getMaskElement("page-mask", "single-file-page-mask"); let selectedNote, highlightSelectionMode, removeHighlightMode, resizingNoteMode, movingNoteMode, collapseNoteTimeout, cuttingMode, cuttingOuterMode; window.onresize = reflowNotes; window.onUpdate = () => {}; document.documentElement.onmouseup = document.documentElement.ontouchend = onMouseUp; window.addEventListener("DOMContentLoaded", () => { processNode(document); reflowNotes(); document.querySelectorAll("single-file-note").forEach(noteElement => attachNoteListeners(noteElement)); }); })()</script><style>.single-file-highlight-yellow, .single-file-highlight-yellow-mode ::selection { background-color: #ffff7c !important; color: black !important; } .single-file-highlight-pink, .single-file-highlight-pink-mode ::selection { background-color: #ffbbb6 !important; color: black !important; } .single-file-highlight-blue, .single-file-highlight-blue-mode ::selection { background-color: #95d0ff !important; color: black !important; } .single-file-highlight-green, .single-file-highlight-green-mode ::selection { background-color: #93ef8d !important; color: black !important; } span.single-file-highlight-yellow, span.single-file-highlight-pink, span.single-file-highlight-blue, span.single-file-highlight-green { display: inline !important; } .single-file-highlight-hidden { background-color: inherit !important; color: inherit !important; } .single-file-mask { all: initial; display: contents !important; } .single-file-mask.single-file-page-mask { opacity: .99 !important; } single-file-note { all: initial !important; display: contents !important; } .single-file-cut-hover, .single-file-cut-outer-hover, .single-file-cut-selected, .single-file-cut-outer-selected { transition: outline-width 125ms !important; outline-offset: -4px !important; outline-width: 4px !important; } .single-file-cut-hover, .single-file-cut-outer-hover { outline-style: dotted !important; } .single-file-cut-selected, .single-file-cut-outer-selected { outline-style: dashed !important; } .single-file-cut-hover, .single-file-cut-selected { outline-color: red !important; } .single-file-cut-outer-hover, .single-file-cut-outer-selected { outline-color: green !important; } .single-file-cut-mode, .single-file-cut-mode * { pointer-events: auto !important; } .single-file-cut-hover, .single-file-cut-outer-hover, .single-file-remove-highlights-mode .single-file-highlight:hover { cursor: crosshair !important; } .single-file-removed { display: none !important; float: none !important; position: static !important; visibility: collapse !important; }</style>